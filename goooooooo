Swal.fire({
    title: 'What do you want to do?',
    text: 'Choose an option for this booking',
    icon: 'question',
    showCancelButton: true,
    confirmButtonText: 'Submit Now',
    cancelButtonText: 'Save as Draft',
    reverseButtons: true
}).then((result) => {
    console.log("Swal result:", result); // Log the result object
    let requestStatus = result.isConfirmed ? 1 : 0; // Correct assignment
    let actionText = result.isConfirmed ? 'submitted' : 'saved as draft';

    console.log("Request Status:", requestStatus); // Cek apakah status benar

    // Jalankan POST pertama untuk kedua opsi
    sendRequest(apiurl + "/" + modname, "POST", {
        requestStatus: requestStatus,
        text: appointmentData.text,
        description: appointmentData.description,
        startDate: appointmentData.startDate,
        endDate: appointmentData.endDate,
        ghm_room_id: appointmentData.ghm_room_id,
        employee_id: appointmentData.employee_id,
        guest: appointmentData.guest,
        family: appointmentData.family
    }).then(() => {
        if (result.isConfirmed) {
            // Hanya jalankan POST kedua jika Submit Now diklik
            sendRequest(apiurl + "/submissionrequest/" + reqid + "/" + modelclass, "POST", {
                requestStatus: 1,
                action: actionForm,
                approvalAction: parseInt(valapprovalAction) || 1,
                approvalType: valApprovalType,
            }).then(function(response) {
                if (response.status === 'success') {
                    e.component._dataSource.reload();
                    Swal.fire({
                        icon: 'success',
                        title: 'Success!',
                        text: `Booking has been ${actionText}.`,
                        timer: 2000,
                        showConfirmButton: false
                    });
                } else {
                    Swal.fire({ icon: 'error', title: 'Error', text: response.message });
                }
            }).catch(function(error) {
                Swal.fire({ icon: 'error', title: 'Error', text: error.responseText });
            });
        } else {
            // Jika hanya Save as Draft, tampilkan pesan sukses langsung
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: `Booking has been ${actionText}.`,
                timer: 2000,
                showConfirmButton: false
            });
        }
    }).catch(function(error) {
        Swal.fire({ icon: 'error', title: 'Error', text: error.responseText });
    });
});
